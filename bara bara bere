import pygame

# Инициализация игрового окна
pygame.init()
win_width, win_height = 1440, 1080
win = pygame.display.set_mode((win_width, win_height))
pygame.display.set_caption("Платформер с прыжками")

# Загрузка изображений фона, персонажа и платформы
background = pygame.image.load("background.jpg")
player_img = pygame.image.load("player.png")
platform_img = pygame.image.load("platform.png")

# Приведение изображений к нужным размерам
background = pygame.transform.scale(background, (win_width, win_height))
player_img = pygame.transform.scale(player_img, (50, 50))
platform_img = pygame.transform.scale(platform_img, (100, 20))

# Параметры персонажа
player_x, player_y = win_width // 2, win_height - player_img.get_height() - 10
player_vel = 5
is_jump = False
jump_count = 10

# Параметры платформ
platforms = [
    (win_width // 2 - platform_img.get_width() // 2, win_height - platform_img.get_height() - 10),
    (win_width // 2 - platform_img.get_width() // 2 - 200, win_height - platform_img.get_height() - 100),
    (win_width // 2 - platform_img.get_width() // 2 + 200, win_height - platform_img.get_height() - 200),
    (win_width // 2 - platform_img.get_width() // 2, win_height - platform_img.get_height() * 2 - 50),
    (win_width // 2 - platform_img.get_width() // 2 - 200, win_height - platform_img.get_height() * 3 - 50),
    (win_width // 2 - platform_img.get_width() // 2 + 200, win_height - platform_img.get_height() * 4 - 50)
]

# Основной игровой цикл
running = True
clock = pygame.time.Clock()
while running:
    clock.tick(60)  # Ограничиваем FPS

    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False

    keys = pygame.key.get_pressed()
    # Движение персонажа влево и вправо
    if keys[pygame.K_LEFT] and player_x > player_vel:
        player_x -= player_vel
    if keys[pygame.K_RIGHT] and player_x < win_width - player_img.get_width() - player_vel:
        player_x += player_vel
    
    # Проверка столкновений с платформами
    for platform in platforms:
        if player_y + player_img.get_height() >= platform[1] and \
                player_y + player_img.get_height() <= platform[1] + platform_img.get_height() and \
                player_x + player_img.get_width() >= platform[0] and \
                player_x <= platform[0] + platform_img.get_width():
            is_jump = False
            jump_count = 10
            player_y = platform[1] - player_img.get_height()
            break
    
    # Прыжок персонажа
    if not is_jump:
        if keys[pygame.K_SPACE]:
            is_jump = True
    else:
        if jump_count >= -10:
            neg = 1
            if jump_count < 0:
                neg = -1
            player_y -= int((jump_count ** 2) * 0.5 * neg)
            jump_count -= 1
        else:
            is_jump = False
            jump_count = 10

    # Рендеринг фона, персонажа и платформ
    win.blit(background, (0, 0))  # Рисуем фон
    win.blit(player_img, (player_x, player_y))  # Рисуем персонаж
    
    for platform in platforms:
        win.blit(platform_img, platform)  # Рисуем платформы
    
    pygame.display.update()

pygame.quit()
